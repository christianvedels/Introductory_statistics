---
output:
  xaringan::moon_reader:
    seal: false
    includes:
      after_body: insert-logo.html
    self_contained: false
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
editor_options:
  chunk_output_type: console
---
class: center, inverse, middle

```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```

```{r xaringan-tile-view, echo=FALSE}
xaringanExtra::use_tile_view()
```

```{r xaringanExtra, echo = FALSE}
xaringanExtra::use_progress_bar(color = "#808080", location = "top")
```

```{css echo=FALSE}
.pull-left {
  float: left;
  width: 44%;
}
.pull-right {
  float: right;
  width: 44%;
}
.pull-right ~ p {
  clear: both;
}


.pull-left-wide {
  float: left;
  width: 66%;
}
.pull-right-wide {
  float: right;
  width: 66%;
}
.pull-right-wide ~ p {
  clear: both;
}

.pull-left-narrow {
  float: left;
  width: 30%;
}
.pull-right-narrow {
  float: right;
  width: 30%;
}

.tiny123 {
  font-size: 0.40em;
}

.small123 {
  font-size: 0.80em;
}

.large123 {
  font-size: 2em;
}

.red {
  color: red
}

.orange {
  color: orange
}

.green {
  color: green
}
```



# Statistik
## Forelæsning 6: Stokastiske processer

### Christian Vedel,<br>Department of Economics

### Email: [christian-vs@sam.sdu.dk](christian-vs@sam.sdu.dk)

### Opdateret `r Sys.Date()`



.footnote[
.left[
.small123[
*Kapitel 7 i "Probability and Statistics for Economists" af Bruce Hansen*
]
]
]


---
class: middle
# Dagens forelæsning
.pull-left-wide[
**Emner:**

- Definition af stokastiske processer
- Transformationer
- Tilstande og ventetider
- Bernoulli- og binomialprocesser
- Poissonprocessen
- Gaussisk random walk
- Wienerprocessen
]

.pull-right-narrow[
![Trees](Figures/Trees1.jpg)
]

---
class: inverse, middle, center
# Stokastiske processer

---
# Tidsdimension

--
Ofte involverer usikre situationer en tidsdimension (f.eks. udviklingen i en aktiekurs over tid)

--

**Eksempel:** Et par skal hver morgen beslutte, hvem der tager skraldet ud
- For at gøre det fair kaster de en mønt hver morgen

--

Lad $Z_t$ angive, hvem der tog skraldet ud på morgen $t$:
$$Z_t = \begin{cases} 0, & \text{hvis manden tager skraldet ud} \\ 1, & \text{hvis konen tager skraldet ud} \end{cases}$$

---
# Interessante spørgsmål

--
- Hvor mange gange tog konen skraldet ud på et år, i gennemsnit?

--
- Hvad er sandsynligheden for, at én af dem tager skraldet ud en hel uge i træk?

--
- Hvor mange dages "pause" kan de forvente mellem de dage, de tager skraldet ud?

---
# Stokastisk proces: Definition

--
> En **stokastisk proces** $\{Z_t, t \in T\}$ er en samling af stokastiske variable $Z_t$ indekseret af tid $t$, som tilhører indeksmængden $T$.

--

- **Realisering** (sample path): Udfaldet af en stokastisk proces, $\{z_t, t \in T\}$

--
- **Hændelse** (incident): Udfaldet $z_t$ af én af de stokastiske variable $Z_t$

---
# Typer af stokastiske processer

--
Ligesom stokastiske variable kan stokastiske processer være:

--

.pull-left[
### Diskret tid
- Indeksmængden $T$ er tællelig (endelig eller uendelig)
- F.eks. $T = \{1, 2, 3, \ldots\}$
]

--

.pull-right[
### Kontinuert tid
- Indeksmængden $T$ er utællelig
- F.eks. $T = (0, \infty)$
]

---
# Eksempel: Realisering

--
Antag vi følger vores par i en uge: $T = \{1, 2, \ldots, 7\}$

--

En realisering kunne være:
$$z = \{1, 0, 0, 1, 1, 1, 0\}$$

--

Dvs. $z_1 = 1$ (konen), $z_2 = 0$ (manden), $z_3 = 0$ (manden), ...

--

Hvis møntkastene er uafhængige, er sandsynligheden for hver sample path:
$$P(z) = 0.5^7 = 0.0078$$

---
class: inverse, middle, center
# Transformationer

---
# Delsum (partial sum)

--
Antag vi vil se, hvor mange gange konen har taget skraldet ud indtil en given dato

--

Vi definerer:
$$X_t = Z_1 + Z_2 + \ldots + Z_t = \sum_{s=1}^t Z_s$$

--

Processen $\{X_t, t \in T\}$ er en **delsumtransformation** af $\{Z_t, t \in T\}$

--

I vores eksempel: $x = \{1, 1, 1, 2, 3, 4, 4\}$

---
# Første differens

--
En anden nyttig transformation viser ændringen fra én periode til den næste

--

**Absolut ændring:**
$$X_t = \Delta Z_t = Z_t - Z_{t-1}$$

--

**Relativ ændring** (f.eks. inflationsrate):
$$X_t = \frac{Z_t - Z_{t-1}}{Z_{t-1}}$$

--

Bemærk: Den transformerede proces er "kortere" med én periode!

---
class: inverse, middle, center
# Tilstande og ventetider

---
# Tilstand (state)

--
> **Tilstanden** af en stokastisk proces på tidspunkt $t$ er givet ved den stokastiske variabel, der repræsenterer værdien på tidspunkt $t$

--

**Eksempel:**

Tilstanden af delsumprocessen $\{X_t\}$ på tidspunkt $t_0 = 2$ er simpelthen $X_2$

---
# Tilstandsfordeling

--
$X_2$ (summen af $Z_1$ og $Z_2$) kan tage tre værdier: 0, 1 eller 2

--

| Værdi | Sandsynlighed |
|-------|---------------|
| $P(X_2 = 0)$ | $P(Z_1 = 0, Z_2 = 0) = 0.25$ |
| $P(X_2 = 1)$ | $P(Z_1 = 0, Z_2 = 1) + P(Z_1 = 1, Z_2 = 0) = 0.5$ |
| $P(X_2 = 2)$ | $P(Z_1 = 1, Z_2 = 1) = 0.25$ |

--

Fordelingen af $X_2$ kaldes **tilstandsfordelingen** på tidspunkt 2

---
# Ventetid (waiting time)

--
> **Ventetiden** er den tid, det tager, indtil en bestemt tilstand nås for første gang

--

Lad $Y_2$ være den stokastiske variabel, der angiver, hvor lang tid det tager, før konen har taget skraldet ud to gange

--

**Ventetidsfordeling:**
- $Y_2 = 2$ hvis $Z_1 = 1$ og $Z_2 = 1$ $\Rightarrow$ $P(Y_2 = 2) = 0.25$
- $Y_2 = 3$ hvis $(Z_1=1, Z_2=0, Z_3=1)$ eller $(Z_1=0, Z_2=1, Z_3=1)$
  - $\Rightarrow$ $P(Y_2 = 3) = 2 \cdot 0.125 = 0.25$

---
# Typer af processer

--
.small123[
| | Diskret tilstand | Kontinuert tilstand |
|---|:---:|:---:|
| **Diskret tid** | Bernoulli, Binomial | Gaussisk random walk |
| **Kontinuert tid** | Poisson | Wiener |
]

---
class: inverse, middle, center
# Bernoulli- og binomialprocesser

---
# Bernoulliprocessen

--
> En **Bernoulliproces** $\{Z_t, t \in T\}$ opfylder:

--

1. **Tid:** $T = \{1, 2, 3, \ldots\}$

--

2. **Tilstand:** $Z_t \in \{0, 1\}$ for alle $t$

--

3. **Fordeling:** Hver tilstand følger Bernoulli med parameter $p$

--

4. **Uafhængighed:** $Z_t$ og $Z_s$ er uafhængige for alle $s \neq t$

---
# Binomialprocessen

--
Hvis vi er interesserede i *antallet* af hændelser i en Bernoulliproces:

$$X_t = \sum_{s=1}^t Z_s$$

--

Dette giver en **binomialproces**

--

> **Binomialproces:** Tilstandsfordelingen er binomial
> $$X_t \sim Bin(t, p)$$

--

**Egenskaber:**
- $E(X_t) = t \cdot p$
- $Var(X_t) = t \cdot p \cdot (1-p)$

---
# Ventetid i binomialprocessen

--
Ventetiden $Y_{x_0}$ indtil $x_0$ succeser følger en **negativ binomialfordeling**:
$$Y_{x_0} \sim Negbin(x_0, p)$$

--

**Geometrisk fordeling:** Ventetid indtil første succes
$$Y_1 \sim Geo(p)$$
$$f(y) = p \cdot (1-p)^{y-1}$$

---
class: inverse, middle, center
# Poissonprocessen

---
# Poissonprocessen

--
> En **Poissonproces** $\{X_t, t \in T\}$ opfylder:

--

1. **Tid:** $T = (0, \infty)$ (kontinuert)

--

2. **Tilstand:** $X_t \in \{0, 1, 2, \ldots\}$

--

3. **Fordeling:** $(X_{t+\tau} - X_t) \sim Poisson(\lambda \cdot \tau)$

--

4. **Uafhængighed:** Ændringer i ikke-overlappende intervaller er uafhængige

---
# Poissonprocessen: Egenskaber

--
**Tilstandsfordeling:**
$$X_t \sim Poisson(\lambda \cdot t)$$

--

**Momenter:**
- $E(X_t) = \lambda \cdot t$
- $Var(X_t) = \lambda \cdot t$

--

**Ventetidsfordeling:** Erlang-fordeling
$$Y_{x_0} \sim Erlang(\lambda, x_0)$$

--

**Eksponentielfordeling:** Ventetid til første/næste hændelse
$$Y_1 \sim Exp(\lambda)$$

---
class: inverse, middle, center
# Gaussisk random walk

---
# Gaussisk random walk

--
> En **Gaussisk random walk** $\{X_t, t \in T\}$ opfylder:

--

1. **Tid:** $T = \{1, 2, 3, \ldots\}$ (diskret)

--

2. **Tilstand:** $X_t \in (-\infty, \infty)$ (kontinuert)

--

3. **Fordeling:** $(X_{t+n} - X_t) \sim \mathcal{N}(n \cdot \mu, n \cdot \sigma^2)$
   - $\mu$: drift-parameter
   - $\sigma^2$: diffusions-parameter

--

4. **Uafhængighed:** Ændringer i ikke-overlappende intervaller er uafhængige

---
# Gaussisk random walk: Tilstand

--
**Tilstandsfordeling:**
$$X_t \sim \mathcal{N}(t \cdot \mu, t \cdot \sigma^2)$$

--

**Momenter:**
- $E(X_t) = t \cdot \mu$
- $Var(X_t) = t \cdot \sigma^2$

--

"Den berusede gang": Hvert skridt kan forekomme i en tilfældig retning

---
class: inverse, middle, center
# Wienerprocessen

---
# Wienerprocessen (Brownsk bevægelse)

--
> En **Wienerproces** $\{X_t, t \in T\}$ er som en Gaussisk random walk, men i **kontinuert tid**

--

1. **Tid:** $T = (0, \infty)$

--

2. **Tilstand:** $X_t \in (-\infty, \infty)$

--

3. **Fordeling:** $(X_{t+\tau} - X_t) \sim \mathcal{N}(\tau \cdot \mu, \tau \cdot \sigma^2)$

--

4. **Uafhængighed:** Ændringer i ikke-overlappende intervaller er uafhængige

---
# Wienerprocessen vs. Gaussisk random walk

--
| Egenskab | Gaussisk random walk | Wienerproces |
|----------|----------------------|--------------|
| Tid | Diskret | Kontinuert |
| Ændringer | Ved heltals-tidspunkter | Kontinuerligt |
| Tilstandsfordeling | Identisk | Identisk |

--

**Ventetidsfordeling:** Invers Gaussisk (Wald) fordeling
$$Y_{x_0} \sim IG\left(\frac{x_0}{\mu}, \frac{x_0^2}{\sigma^2}\right)$$

---
# Opsummering

--
.small123[
| Proces | Tid | Tilstand | Tilstandsfordeling | Ventetidsfordeling |
|--------|-----|----------|-------------------|-------------------|
| Bernoulli | Diskret | Diskret | Bernoulli | - |
| Binomial | Diskret | Diskret | Binomial | Negativ binomial |
| Poisson | Kontinuert | Diskret | Poisson | Erlang |
| Gaussisk RW | Diskret | Kontinuert | Normal | - |
| Wiener | Kontinuert | Kontinuert | Normal | Invers Gaussisk |
]

---
# Før næste gang

.pull-left[
**Læs:**
- Kapitel 7 i lærebogen

**Overvej:**
- Hvornår er en Poissonproces en god model?
- Hvad beskriver drift- og diffusionsparametrene?
]

.pull-right[
![Trees](Figures/Trees1.jpg)
]
